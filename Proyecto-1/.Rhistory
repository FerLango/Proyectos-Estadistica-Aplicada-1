filter(!is.na(Mes_hecho)) %>%
group_by(Año_hecho, Mes_hecho, Categoria) %>%
tally() %>%
arrange(Categoria) %>%
rename(Categoría = Categoria, Mes = Mes_hecho, Delitos=n,
Año = Año_hecho) %>%
filter(Delitos>1)
heat_data
heat_data <-
victimas %>%
select(Mes_hecho, Año_hecho, Categoria) %>%
filter(!is.na(Mes_hecho)) %>%
group_by(Año_hecho, Mes_hecho, Categoria) %>%
tally() %>%
arrange(Categoria) %>%
rename(Categoría = Categoria, Mes = Mes_hecho, Delitos=n,
Año = Año_hecho)
heat <-
heat_data %>%
ggplot(aes(x=Mes, y=Categoría, fill=log(Delitos), size=Delitos)) +
geom_tile() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45)) +
scale_y_discrete(labels=
substr(unique(sort(victimas$Categoria)),
0,35)) +
scale_fill_gradient(low="yellow", high = "red") +
labs(title = "Tipo de delito respecto a cada mes",
x = "Mes",
y = "Tipo de delito")
heat <-
heat_data %>%
ggplot(aes(x=Mes, y=Categoría, fill=log(Delitos), size=Delitos)) +
geom_tile() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45)) +
scale_y_discrete(labels=
substr(unique(sort(victimas$Categoria)),
0,35)) +
scale_fill_gradient(low="yellow", high = "red") +
labs(title = "Tipo de delito respecto a cada mes",
x = "Mes",
y = "Tipo de delito") +
facet_wrap(.~Año)
heat
heat_data <-
victimas %>%
select(Mes_hecho, Año_hecho, Categoria) %>%
filter(!is.na(Mes_hecho)) %>%
group_by(Año_hecho, Mes_hecho, Categoria) %>%
tally() %>%
arrange(Categoria) %>%
rename(Categoría = Categoria, Mes = Mes_hecho, Delitos=n,
Año = Año_hecho)
View(heat_data)
heat <-
heat_data %>%
ggplot(aes(x=Mes, y=Año, fill=log(Delitos), size=Delitos)) +
geom_tile() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45)) +
#scale_y_discrete(labels=
#                   substr(unique(sort(victimas$Categoria)),
#                          0,35)) +
scale_fill_gradient(low="yellow", high = "red") +
labs(title = "Tipo de delito respecto a cada mes",
x = "Mes",
y = "Tipo de delito") +
facet_wrap(.~Año)
heat <-
heat_data %>%
ggplot(aes(x=Mes, y=Año, fill=log(Delitos), size=Delitos)) +
geom_tile() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45)) +
#scale_y_discrete(labels=
#                   substr(unique(sort(victimas$Categoria)),
#                          0,35)) +
scale_fill_gradient(low="yellow", high = "red") +
labs(title = "Tipo de delito respecto a cada mes",
x = "Mes",
y = "Tipo de delito")
heat
heat <-
heat_data %>%
ggplot(aes(x=Mes, y=Año, fill=log(Delitos), size=Delitos)) +
geom_tile() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45)) +
#scale_y_discrete(labels=
#                   substr(unique(sort(victimas$Categoria)),
#                          0,35)) +
scale_fill_gradient(low="yellow", high = "red") +
labs(title = "Tipo de delito respecto a cada mes",
x = "Mes",
y = "Tipo de delito") +
facet_wrap(.~Categoría)
heat
heat_data <-
victimas %>%
select(Mes_inicio, Año_inicio, Categoria) %>%
filter(!is.na(Mes_hecho)) %>%
group_by(Año_hecho, Mes_hecho, Categoria) %>%
tally() %>%
arrange(Categoria) %>%
rename(Categoría = Categoria, Mes = Mes_hecho, Delitos=n,
Año = Año_hecho)
heat_data <-
victimas %>%
select(Mes_inicio, Año_inicio, Categoria) %>%
filter(!is.na(Mes_inicio)) %>%
group_by(Año_inicio, Mes_inicio, Categoria) %>%
tally() %>%
arrange(Categoria) %>%
rename(Categoría = Categoria, Mes = Mes_inicio, Delitos=n,
Año = Año_inicio)
heat <-
heat_data %>%
ggplot(aes(x=Mes, y=Año, fill=log(Delitos), size=Delitos)) +
geom_tile() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45)) +
#scale_y_discrete(labels=
#                   substr(unique(sort(victimas$Categoria)),
#                          0,35)) +
scale_fill_gradient(low="yellow", high = "red") +
labs(title = "Tipo de delito respecto a cada mes",
x = "Mes",
y = "Tipo de delito") +
facet_wrap(.~Categoría)
heat
?geom_tile
heat_data <-
victimas %>%
select(Mes_hecho, Año_hecho, Categoria) %>%
filter(!is.na(Mes_hecho)) %>%
group_by(Mes_hecho, Categoria) %>%
tally() %>%
arrange(Categoria) %>%
rename(Categoría = Categoria, Mes = Mes_hecho, Delitos=n,
Año = Año_hecho)
heat_data <-
victimas %>%
select(Mes_hecho, Categoria) %>%
filter(!is.na(Mes_hecho)) %>%
group_by(Mes_hecho, Categoria) %>%
tally() %>%
arrange(Categoria) %>%
rename(Categoría = Categoria, Mes = Mes_hecho, Delitos=n)
heat <-
heat_data %>%
ggplot(aes(x=Mes, y=Categoría, fill=log(Delitos), size=Delitos)) +
geom_tile() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45)) +
scale_y_discrete(labels=
substr(unique(sort(victimas$Categoria)),
0,35)) +
scale_fill_gradient(low="yellow", high = "red") +
labs(title = "Tipo de delito respecto a cada mes",
x = "Mes",
y = "Tipo de delito") +
ggplotly(heat, dynamicTicks = TRUE, width = 800,
tooltip = c("Categoría", "Mes", "Delitos"))
heat <-
heat_data %>%
ggplot(aes(x=Mes, y=Categoría, fill=log(Delitos), size=Delitos)) +
geom_tile() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45)) +
scale_y_discrete(labels=
substr(unique(sort(victimas$Categoria)),
0,35)) +
scale_fill_gradient(low="yellow", high = "red") +
labs(title = "Tipo de delito respecto a cada mes",
x = "Mes",
y = "Tipo de delito")
heat
heat <-
heat_data %>%
ggplot(aes(x=Mes, y=Categoría, fill=log(Delitos), size=Delitos)) +
geom_tile() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45)) +
scale_y_discrete(labels=
substr(unique(sort(victimas$Categoria)),
0,35)) +
scale_fill_gradient2(midpoint = mean(log(heat_data$Delitos))) +
labs(title = "Tipo de delito respecto a cada mes",
x = "Mes",
y = "Tipo de delito")
heat
heat <-
heat_data %>%
ggplot(aes(x=Mes, y=Categoría, fill=log(Delitos), size=Delitos)) +
geom_tile() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45)) +
scale_y_discrete(labels=
substr(unique(sort(victimas$Categoria)),
0,35)) +
scale_fill_gradient2(low="green", mid="yellow", high="red",
midpoint = mean(log(heat_data$Delitos))) +
labs(title = "Tipo de delito respecto a cada mes",
x = "Mes",
y = "Tipo de delito")
ggplotly(heat, dynamicTicks = TRUE, width = 800,
tooltip = c("Categoría", "Mes", "Delitos"))
?log
heat <-
heat_data %>%
ggplot(aes(x=Mes, y=Categoría, fill=log10(Delitos), size=Delitos)) +
geom_tile() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45)) +
scale_y_discrete(labels=
substr(unique(sort(victimas$Categoria)),
0,35)) +
scale_fill_gradient2(low="green", mid="yellow", high="red",
midpoint = mean(log10(heat_data$Delitos))) +
labs(title = "Tipo de delito respecto a cada mes",
x = "Mes",
y = "Tipo de delito")
ggplotly(heat, dynamicTicks = TRUE, width = 800,
tooltip = c("Categoría", "Mes", "Delitos"))
log110(heat_data$Delitos)
?log
log(heat_data$Delitos,
base=20)
heat <-
heat_data %>%
ggplot(aes(x=Mes, y=Categoría, fill=log(Delitos, base=20),
size=Delitos)) +
geom_tile() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45)) +
scale_y_discrete(labels=
substr(unique(sort(victimas$Categoria)),
0,35)) +
scale_fill_gradient2(low="green", mid="yellow", high="red",
midpoint = mean(log(heat_data$Delitos,
base=20))) +
labs(title = "Tipo de delito respecto a cada mes",
x = "Mes",
y = "Tipo de delito")
ggplotly(heat, dynamicTicks = TRUE, width = 800,
tooltip = c("Categoría", "Mes", "Delitos"))
heat <-
heat_data %>%
ggplot(aes(x=Mes, y=Categoría, fill=log(Delitos, base=100),
size=Delitos)) +
geom_tile() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45)) +
scale_y_discrete(labels=
substr(unique(sort(victimas$Categoria)),
0,35)) +
scale_fill_gradient2(low="green", mid="yellow", high="red",
midpoint = mean(log(heat_data$Delitos,
base=100))) +
labs(title = "Tipo de delito respecto a cada mes",
x = "Mes",
y = "Tipo de delito")
ggplotly(heat, dynamicTicks = TRUE, width = 800,
tooltip = c("Categoría", "Mes", "Delitos"))
mean(log(heat_data$Delitos,
base=100))
heat <-
heat_data %>%
ggplot(aes(x=Mes, y=Categoría, fill=log(Delitos, base=2),
size=Delitos)) +
geom_tile() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45)) +
scale_y_discrete(labels=
substr(unique(sort(victimas$Categoria)),
0,35)) +
scale_fill_gradient2(low="green", mid="yellow", high="red",
midpoint = mean(log(heat_data$Delitos,
base=2))) +
labs(title = "Tipo de delito respecto a cada mes",
x = "Mes",
y = "Tipo de delito")
ggplotly(heat, dynamicTicks = TRUE, width = 800,
tooltip = c("Categoría", "Mes", "Delitos"))
heat <-
heat_data %>%
ggplot(aes(x=Mes, y=Categoría, fill=log(Delitos, base=3),
size=Delitos)) +
geom_tile() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45)) +
scale_y_discrete(labels=
substr(unique(sort(victimas$Categoria)),
0,35)) +
scale_fill_gradient2(low="green", mid="yellow", high="red",
midpoint = mean(log(heat_data$Delitos,
base=3))) +
labs(title = "Tipo de delito respecto a cada mes",
x = "Mes",
y = "Tipo de delito")
ggplotly(heat, dynamicTicks = TRUE, width = 800,
tooltip = c("Categoría", "Mes", "Delitos"))
heat <-
heat_data %>%
ggplot(aes(x=Mes, y=Categoría, fill=log(Delitos, base=50),
size=Delitos)) +
geom_tile() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45)) +
scale_y_discrete(labels=
substr(unique(sort(victimas$Categoria)),
0,35)) +
scale_fill_gradient2(low="green", mid="yellow", high="red",
midpoint = mean(log(heat_data$Delitos,
base=50))) +
labs(title = "Tipo de delito respecto a cada mes",
x = "Mes",
y = "Tipo de delito")
ggplotly(heat, dynamicTicks = TRUE, width = 800,
tooltip = c("Categoría", "Mes", "Delitos"))
heat <-
heat_data %>%
ggplot(aes(x=Mes, y=Categoría, fill=log(Delitos),
size=Delitos)) +
geom_tile() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45)) +
scale_y_discrete(labels=
substr(unique(sort(victimas$Categoria)),
0,35)) +
scale_fill_gradient2(low="green", mid="yellow", high="red",
midpoint = mean(log(heat_data$Delitos))) +
labs(title = "Tipo de delito respecto a cada mes",
x = "Mes",
y = "Tipo de delito")
ggplotly(heat, dynamicTicks = TRUE, width = 800,
tooltip = c("Categoría", "Mes", "Delitos"))
heat <-
heat_data %>%
ggplot(aes(x=Mes, y=Categoría, fill=log10(Delitos),
size=Delitos)) +
geom_tile() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45)) +
scale_y_discrete(labels=
substr(unique(sort(victimas$Categoria)),
0,35)) +
scale_fill_gradient2(low="green", mid="yellow", high="red",
midpoint = mean(log10(heat_data$Delitos))) +
labs(title = "Tipo de delito respecto a cada mes",
x = "Mes",
y = "Tipo de delito")
ggplotly(heat, dynamicTicks = TRUE, width = 800,
tooltip = c("Categoría", "Mes", "Delitos"))
heat <-
heat_data %>%
ggplot(aes(x=Mes, y=Categoría, fill=log(Delitos),
size=Delitos)) +
geom_tile() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45)) +
scale_y_discrete(labels=
substr(unique(sort(victimas$Categoria)),
0,35)) +
scale_fill_gradient2(low="green", mid="yellow", high="red",
midpoint = mean(log(heat_data$Delitos))) +
labs(title = "Tipo de delito respecto a cada mes",
x = "Mes",
y = "Tipo de delito")
ggplotly(heat, dynamicTicks = TRUE, width = 800,
tooltip = c("Categoría", "Mes", "Delitos"))
A pesar de que el mes parece no representar una gran influencia dentro del tipo de delito, podemos apreciar que los primeros meses del año tienen un ligero aumento en los delitos registrados respecto a los demás. Una de las posibles causas es que debido a las fiestas de fin de año solemos relajarnos y prestamos menos atención a actitudes sospechosas. Además, en esa época del a
heat_data
?table
table(rpois(100, 5))
table(heat_data$Mes, heat_data$Categoría)
table(heat_data$Mes, heat_data$Categoría, heat_data$Delitos)
table(heat_data)
data("mtcars")
head(mtcars)
substr(heat_data$Categoría,0,35)
table(substr(heat_data$Categoría,0,35), heat_data$Mes)
table(substr(heat_data$Categoría,0,35), heat_data$Mes, heat_data$Delitos)
?matrix
matrx(heat$data, nrow = 12)
matrix(heat$data, nrow = 12)
matrix(heat_data$Delitos, nrow = 12)
matrix(heat_data$Delitos, nrow = 16)
matrix(heat_data$Delitos, nrow = 16, byrow = T)
matrix(heat_data$Delitos, nrow = 16, byrow = T, dimnames = list(heat$data))
c(heat$data)
c(heat_data$Categoría)
heat_data$Categoría
matrix(heat_data$Delitos, nrow = 16, byrow = T,
dimnames = list(unique(heat_data$Categoría)))
unique(heat_data$Mes))
matrix(heat_data$Delitos, nrow = 16, byrow = T,
dimnames = list(substr(unique(heat_data$Categoría),0,35),
unique(heat_data$Mes)))
matrix(heat_data$Delitos, nrow = 16, byrow = T,
dimnames = list(substr(unique(heat_data$Categoría),0,10),
unique(heat_data$Mes)))
matrix(heat_data$Delitos, nrow = 16, byrow = T,
dimnames = list(substr(unique(heat_data$Categoría),0,10),
unique(heat_data$Mes))) %>%
kable()
dens <-
victimas %>%
#filter(Edad < 150, Edad>0) %>%
ggplot() +
geom_density(aes(x=Edad,fill=factor(Año_inicio),
color=factor(Año_inicio)),
alpha=0.5, size=1, stat = "count") +
labs(title = "Densidad de la edad por año",
x = "edad",
y = "cantidad de personas",
fill = "Año",
color = "")
ggplotly(dens, tooltip = c("count", "Edad"),
dynamicTicks = TRUE, width = 800)
dens <-
victimas %>%
filter(Edad < 150, Edad>0) %>%
ggplot() +
geom_density(aes(x=Edad,fill=factor(Año_inicio),
color=factor(Año_inicio)),
alpha=0.5, size=1, stat = "count") +
labs(title = "Densidad de la edad por año",
x = "edad",
y = "cantidad de personas",
fill = "Año",
color = "")
ggplotly(dens, tooltip = c("count", "Edad"),
dynamicTicks = TRUE, width = 800)
names(victimas)
victimas %>%
select(FechaInicio, Delito, Categoria, Sexo, Edad) %>%
filter(Edad = 120)
victimas %>%
select(FechaInicio, Delito, Categoria, Sexo, Edad) %>%
filter(Edad == 120)
victimas %>%
select(FechaInicio, Delito, Categoria, Sexo, Edad, TipoPersona,
CalidadJuridica, comppetencia) %>%
filter(Edad == 120)
victimas %>%
select(FechaInicio, Delito, Categoria, Sexo, Edad, TipoPersona,
CalidadJuridica, competencia) %>%
filter(Edad == 120)
victimas %>%
select(FechaInicio, Delito, Categoria, Sexo, Edad, TipoPersona,
CalidadJuridica) %>%
filter(Edad == 120) %>%
kable()
victimas %>%
select(FechaInicio, Delito, Categoria, Sexo, Edad, TipoPersona,
CalidadJuridica) %>%
filter(Edad == 365) %>%
kable()
max(victimas$Edad)
max(victimas$Edad, na.rm = T)
victimas %>%
select(FechaInicio, Delito, Categoria, Sexo, Edad, TipoPersona,
CalidadJuridica) %>%
filter(Edad == 369) %>%
kable()
victimas %>%
select(FechaInicio, Delito, Categoria, Sexo, Edad, TipoPersona,
CalidadJuridica) %>%
filter(Edad == 120) %>%
kable()
victimas %>%
select(FechaInicio, Delito, Categoria, Sexo, Edad, TipoPersona,
CalidadJuridica) %>%
filter(Edad == 120) %>%
rename(Fecha = FechaInicio, Categoría = Categoria,
CalidadJurídica = CalidadJuridica) %>%
kable()
out <-victimas %>%
select(FechaInicio, Delito, Categoria, Sexo, Edad, TipoPersona,
CalidadJuridica) %>%
filter(Edad == 120) %>%
rename(Fecha = FechaInicio, Categoría = Categoria,
CalidadJurídica = CalidadJuridica)
View(out)
out
View(out)
str_replace(out$TipoPersona, "FISICA", "FÍsica")
out <-victimas %>%
select(FechaInicio, Delito, Categoria, Sexo, Edad, TipoPersona,
CalidadJuridica) %>%
filter(Edad == 120) %>%
rename(Fecha = FechaInicio, Categoría = Categoria,
CalidadJurídica = CalidadJuridica)
out$TipoPersona <- str_replace(out$TipoPersona, "FISICA", "FÍsica")
out$CalidadJurídica <-
str_replace(out$CalidadJurídica, "VICTIMA", "VÍCTIMA")
out %>%
kable()
out <-victimas %>%
select(FechaInicio, Delito, Categoria, Sexo, Edad, TipoPersona,
CalidadJuridica) %>%
filter(Edad == 120) %>%
rename(Fecha = FechaInicio, Categoría = Categoria,
CalidadJurídica = CalidadJuridica)
out$TipoPersona <- str_replace(out$TipoPersona, "FISICA", "FÍSICA")
out$CalidadJurídica <-
str_replace(out$CalidadJurídica, "VICTIMA", "VÍCTIMA")
out %>%
kable()
rm(list = ls()[!(ls() %in% c("victimas", "diccionario"))])
